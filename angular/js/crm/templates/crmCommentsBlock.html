<ul class="comments list-unstyled">
    <li ng-repeat="row in crmTask.comments track by $index" ng-class="{'reply-comment':row.id_parent}">
        <div class="col-md-2 no-padding" data-title="'Автор'">
            <img style="width: 48px;height: 48px" ng-src="/images/avatars/{{row.idUser.avatar}}">
            <a ng-href="#/users/profile/{{row.id_user}}" target="_blank">{{row.idUser.fullName}}</a>
        </div>
        <div class="col-md-7 commentMessage" data-title="'Повідомлення'">
            <input type="hidden" ng-init="rowLimit[$index]=200" ng-model="rowLimit[$index]">
            <p ng-bind-html="row.message | limitTo : rowLimit[$index] "></p>
            <p style="text-align:center;margin-bottom:0">
                <a href="" ng-if="row.message.length>200 && rowLimit[$index]!='undefined'"  ng-click="rowLimit[$index]='undefined'" style="margin:0;padding:0" ><i class="fa fa-angle-double-down fa-2x" aria-hidden="true"></i></a>
            </p>
            <p ng-if="!row.id_parent" class="reply" ng-click="crmTask.replyComment($event, row.id)">
                Відповісти
            </p>
        </div>
        <div class="col-md-2" data-title="'Дата створення'">
            {{row.create_date || row.change_date}}
        </div>
        <div class="col-md-1 action-button">
            <a href="" ng-if="row.id_user==currentUser" ng-click="crmTask.removeCommentDialog(row.id)" title="Видалити">
                <i class="fa fa-trash fa-fw"></i>
            </a>
            <a href="" ng-if="row.id_user==currentUser" ng-click="crmTask.editComment($event, row.id, row.message)" title="Редагувати">
                <i class="fa fa-pencil-square-o fa-fw"></i>
            </a>
        </div>
    </li>
</ul>
<br>
<br>
<a href="" ng-show="!newComment" ng-click="crmTask.toggleComment();" >Додати коментар</a>
<div ng-show="newComment">
    <div style="font-size: 12px">
        <b>@</b> - три символи після знаку підтягує список користувачів
        <br>
        <b>#</b> - три символи після знаку підтягує список доступних завдань
    </div>
    <textarea ng-hide="true" id="comment_cke" crm-ckeditor="ckeditorOptions" class="mention" ng-cloak ng-model="comment.message" required></textarea>
    <br>
    <p style="clear: both">
        <button type="button" class="btn btn-success" ng-click="crmTask.addComment(comment)" >Додати</button>
        <button type="button" class="btn btn-default" ng-click="crmTask.toggleComment();" >Відміна</button>
    </p>
</div>